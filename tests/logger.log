2025-07-09 16:02:55,884 - INFO - Downloading dataset 'wikipedia' with config '20220301.en' from Hugging Face...
2025-07-09 16:02:55,884 - INFO - Performance dataset_loading: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:02:55,885 - INFO - Performance dataset_processing_and_saving: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:02:55,885 - INFO - Saved 2 documents to test_dir
2025-07-09 16:02:55,885 - INFO - Performance huggingface_dataset_download: 0.02s, Memory: +2.7MB, GPU: +0.0MB
2025-07-09 16:02:55,889 - INFO - Validating URL: https://example.com/data
2025-07-09 16:02:55,889 - INFO - Downloading data from URL: https://example.com/data
2025-07-09 16:02:55,890 - INFO - Performance url_streaming_download: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:02:55,890 - INFO - Downloaded and saved corpus to test_dir/corpus.txt
2025-07-09 16:02:55,890 - INFO - Performance url_download: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:02:55,891 - INFO - Parsing source path: invalid_format
2025-07-09 16:02:55,891 - ERROR - Unsupported source path format: invalid_format
2025-07-09 16:02:55,891 - INFO - Performance source_path_parsing: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:02:55,891 - INFO - Validating URL: ftp://example.com/data
2025-07-09 16:02:55,891 - ERROR - URL must use HTTPS.
2025-07-09 16:02:55,894 - INFO - Parsing source path: wikipedia:20220301.en
2025-07-09 16:02:55,894 - INFO - Source type identified as Hugging Face dataset with config: wikipedia_20220301.en
2025-07-09 16:02:55,894 - INFO - Performance source_path_parsing: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:02:55,895 - INFO - Parsing source path: https://example.com/corpus.txt
2025-07-09 16:02:55,895 - INFO - Source type identified as URL with corpus name: corpus.txt
2025-07-09 16:02:55,895 - INFO - Performance source_path_parsing: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:02:55,896 - INFO - Validating URL: http://example.com/data
2025-07-09 16:02:55,897 - ERROR - URL must use HTTPS.
2025-07-09 16:02:55,897 - INFO - Validating URL: https://example.com/data
2025-07-09 16:02:55,899 - INFO - Validating URL: https://malicious-site.com/data
2025-07-09 16:02:55,899 - ERROR - Domain 'malicious-site.com' is not allowed.
2025-07-09 16:02:55,900 - INFO - Loading vector database from source: local, source_path: None
2025-07-09 16:02:58,059 - INFO - Performance embedding_model_initialization: 2.16s, Memory: +123.2MB, GPU: +0.0MB
2025-07-09 16:02:58,177 - INFO - Indexing documents from local data path...
2025-07-09 16:03:00,371 - INFO - Indexed and saved new local corpus to 'storage/'.
2025-07-09 16:03:00,372 - INFO - Performance complete_vector_db_loading: 4.47s, Memory: +188.7MB, GPU: +0.0MB
2025-07-09 16:04:06,008 - INFO - Downloading dataset 'wikipedia' with config '20220301.en' from Hugging Face...
2025-07-09 16:04:06,009 - INFO - Performance dataset_loading: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:04:06,010 - INFO - Performance dataset_processing_and_saving: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:04:06,010 - INFO - Saved 2 documents to test_dir
2025-07-09 16:04:06,010 - INFO - Performance huggingface_dataset_download: 0.02s, Memory: +2.8MB, GPU: +0.0MB
2025-07-09 16:04:06,014 - INFO - Validating URL: https://example.com/data
2025-07-09 16:04:06,014 - INFO - Downloading data from URL: https://example.com/data
2025-07-09 16:04:06,014 - INFO - Performance url_streaming_download: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:04:06,014 - INFO - Downloaded and saved corpus to test_dir/corpus.txt
2025-07-09 16:04:06,014 - INFO - Performance url_download: 0.00s, Memory: +0.1MB, GPU: +0.0MB
2025-07-09 16:04:06,016 - INFO - Parsing source path: invalid_format
2025-07-09 16:04:06,016 - ERROR - Unsupported source path format: invalid_format
2025-07-09 16:04:06,016 - INFO - Performance source_path_parsing: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:04:06,016 - INFO - Validating URL: ftp://example.com/data
2025-07-09 16:04:06,016 - ERROR - URL must use HTTPS.
2025-07-09 16:04:06,018 - INFO - Parsing source path: wikipedia:20220301.en
2025-07-09 16:04:06,018 - INFO - Source type identified as Hugging Face dataset with config: wikipedia_20220301.en
2025-07-09 16:04:06,018 - INFO - Performance source_path_parsing: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:04:06,019 - INFO - Parsing source path: https://example.com/corpus.txt
2025-07-09 16:04:06,019 - INFO - Source type identified as URL with corpus name: corpus.txt
2025-07-09 16:04:06,019 - INFO - Performance source_path_parsing: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-09 16:04:06,020 - INFO - Validating URL: http://example.com/data
2025-07-09 16:04:06,020 - ERROR - URL must use HTTPS.
2025-07-09 16:04:06,021 - INFO - Validating URL: https://example.com/data
2025-07-09 16:04:06,022 - INFO - Validating URL: https://malicious-site.com/data
2025-07-09 16:04:06,022 - ERROR - Domain 'malicious-site.com' is not allowed.
2025-07-09 16:04:06,023 - INFO - Loading vector database from source: local, source_path: None
2025-07-09 16:04:08,080 - INFO - Performance embedding_model_initialization: 2.06s, Memory: +123.0MB, GPU: +0.0MB
2025-07-09 16:04:08,199 - INFO - Indexing documents from local data path...
2025-07-09 16:04:09,440 - INFO - Indexed and saved new local corpus to 'storage/'.
2025-07-09 16:04:09,440 - INFO - Performance complete_vector_db_loading: 3.42s, Memory: +208.3MB, GPU: +0.0MB
2025-07-11 12:07:12,752 - INFO - MPS (Apple Silicon GPU) detected and enabled
2025-07-11 12:07:12,753 - INFO - Loading Model tiiuae/falcon-rw-1b with MPS compatibility...
2025-07-11 12:07:12,753 - INFO - MPS (Apple Silicon GPU) detected and enabled
2025-07-11 12:07:13,349 - INFO - Added padding token to tokenizer.
2025-07-11 12:07:13,349 - INFO - Tokenizer loaded successfully.
2025-07-11 12:07:13,350 - INFO - Loading model with MPS-specific optimizations...
2025-07-11 12:07:18,607 - INFO - Model successfully loaded and converted for MPS
2025-07-11 12:07:18,607 - INFO - Model loading completed successfully
2025-07-11 12:07:18,608 - INFO - Performance complete_model_loading: 5.86s, Memory: +129.8MB, GPU: +0.0MB
2025-07-11 12:07:18,610 - INFO - Loading Model tiiuae/falcon-rw-1b with MPS compatibility...
2025-07-11 12:07:18,610 - INFO - MPS (Apple Silicon GPU) detected and enabled
2025-07-11 12:07:19,147 - INFO - Added padding token to tokenizer.
2025-07-11 12:07:19,147 - INFO - Tokenizer loaded successfully.
2025-07-11 12:07:19,147 - INFO - Loading model with MPS-specific optimizations...
2025-07-11 12:07:33,132 - INFO - Model successfully loaded and converted for MPS
2025-07-11 12:07:33,132 - INFO - Model loading completed successfully
2025-07-11 12:07:33,132 - INFO - Performance complete_model_loading: 14.52s, Memory: -175.3MB, GPU: +0.0MB
2025-07-11 12:07:33,143 - INFO - Loading Model tiiuae/falcon-rw-1b with MPS compatibility...
2025-07-11 12:07:33,143 - INFO - MPS (Apple Silicon GPU) detected and enabled
2025-07-11 12:07:33,406 - INFO - Added padding token to tokenizer.
2025-07-11 12:07:33,406 - INFO - Tokenizer loaded successfully.
2025-07-11 12:07:33,406 - INFO - Loading model with MPS-specific optimizations...
2025-07-11 12:07:41,614 - INFO - Model successfully loaded and converted for MPS
2025-07-11 12:07:41,614 - INFO - Model loading completed successfully
2025-07-11 12:07:41,614 - INFO - Performance complete_model_loading: 8.47s, Memory: +443.4MB, GPU: +0.0MB
2025-07-11 12:07:41,903 - ERROR - Generation failed: BFloat16 is not supported on MPS
2025-07-11 12:07:41,903 - INFO - Attempting CPU fallback...
2025-07-11 12:07:51,519 - INFO - Loading Model tiiuae/falcon-rw-1b with MPS compatibility...
2025-07-11 12:07:51,519 - INFO - MPS (Apple Silicon GPU) detected and enabled
2025-07-11 12:07:51,889 - INFO - Added padding token to tokenizer.
2025-07-11 12:07:51,889 - INFO - Tokenizer loaded successfully.
2025-07-11 12:07:51,889 - INFO - Loading model with MPS-specific optimizations...
2025-07-11 12:08:08,110 - INFO - Model successfully loaded and converted for MPS
2025-07-11 12:08:08,110 - INFO - Model loading completed successfully
2025-07-11 12:08:08,110 - INFO - Performance complete_model_loading: 16.59s, Memory: -840.3MB, GPU: +0.0MB
2025-07-11 12:08:08,111 - INFO - Processing query with SimilarityMethod.COSINE similarity
2025-07-11 12:08:08,111 - INFO - Performance preparing_query_context: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-11 12:08:08,114 - INFO - Performance tokenization: 0.00s, Memory: +1.2MB, GPU: +0.0MB
2025-07-11 12:08:08,144 - ERROR - Generation failed: BFloat16 is not supported on MPS
2025-07-11 12:08:08,144 - INFO - Attempting CPU fallback...
2025-07-11 12:08:22,092 - INFO - Performance text_generation: 13.98s, Memory: +872.6MB, GPU: +0.0MB
2025-07-11 12:08:22,093 - INFO - Evaluating answer quality
2025-07-11 12:08:22,093 - INFO - Quality score: 1.0
2025-07-11 12:08:22,093 - INFO - Performance answer_quality_evaluation: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-11 12:08:22,093 - INFO - Performance answer_processing: 0.00s, Memory: +0.4MB, GPU: +0.0MB
2025-07-11 12:08:22,094 - INFO - Performance single_answer_generating: 13.98s, Memory: +874.1MB, GPU: +0.0MB
2025-07-11 12:08:22,094 - INFO - Query processing completed successfully
2025-07-11 12:08:22,094 - INFO - Performance complete_query_processing: 13.98s, Memory: +874.1MB, GPU: +0.0MB
2025-07-11 12:08:22,613 - INFO - Loading vector database from source: url, source_path: wikipedia:20220301.en, storing_method: chroma
2025-07-11 12:08:24,625 - INFO - Loading Model tiiuae/falcon-rw-1b with MPS compatibility...
2025-07-11 12:08:24,625 - INFO - MPS (Apple Silicon GPU) detected and enabled
2025-07-11 12:08:24,895 - INFO - Added padding token to tokenizer.
2025-07-11 12:08:24,895 - INFO - Tokenizer loaded successfully.
2025-07-11 12:08:24,895 - INFO - Loading model with MPS-specific optimizations...
2025-07-11 12:08:37,675 - INFO - Model successfully loaded and converted for MPS
2025-07-11 12:08:37,676 - INFO - Model loading completed successfully
2025-07-11 12:08:37,676 - INFO - Performance complete_model_loading: 13.05s, Memory: -937.9MB, GPU: +0.0MB
2025-07-11 12:08:37,676 - WARNING - GPU memory issue: Simulated MPS error
2025-07-11 12:08:37,676 - INFO - Cleared MPS cache
2025-07-11 12:08:37,676 - INFO - Falling back to CPU generation
2025-07-11 12:09:08,493 - INFO - Model moved back to mps:0
2025-07-11 16:45:28,650 - INFO - Testing GPU-optimized model loading...
2025-07-11 16:45:28,651 - INFO - Loading Model tiiuae/falcon-rw-1b with MPS compatibility...
2025-07-11 16:45:28,651 - INFO - MPS (Apple Silicon GPU) detected and enabled
2025-07-11 16:45:29,751 - INFO - Added padding token to tokenizer.
2025-07-11 16:45:29,751 - INFO - Tokenizer loaded successfully.
2025-07-11 16:45:29,751 - INFO - Loading model with MPS-specific optimizations...
2025-07-11 16:45:35,552 - INFO - Model successfully loaded and converted for MPS
2025-07-11 16:45:35,553 - INFO - Model loading completed successfully
2025-07-11 16:45:35,554 - INFO - Performance complete_model_loading: 6.90s, Memory: -342.7MB, GPU: +0.0MB
2025-07-11 16:45:35,554 - INFO - Performance test_model_loading: 6.90s, Memory: -342.2MB, GPU: +0.0MB
2025-07-11 16:45:35,555 - INFO - Performance capability_analysis: 0.00s, Memory: +0.2MB, GPU: +0.0MB
2025-07-11 16:45:35,555 - INFO - Performance model_capabilities_analysis: 0.00s, Memory: +0.3MB, GPU: +0.0MB
2025-07-11 16:45:35,555 - INFO - Performance test_capabilities_analysis: 0.00s, Memory: +0.3MB, GPU: +0.0MB
2025-07-11 16:45:35,555 - INFO - Model loading test results:
2025-07-11 16:45:35,555 - INFO -   PASS can_generate: True
2025-07-11 16:45:35,555 - INFO -   PASS model_type: FalconForCausalLM
2025-07-11 16:45:35,555 - INFO -   PASS is_causal_lm: True
2025-07-11 16:45:35,555 - INFO -   PASS device: mps:0
2025-07-11 16:45:35,555 - INFO -   PASS dtype: torch.float32
2025-07-11 16:45:35,555 - INFO -   PASS parameter_count: 1311625216
2025-07-11 16:45:35,555 - INFO - MPS: Memory monitoring limited on Apple Silicon
2025-07-11 16:45:35,555 - INFO - Performance gpu_memory_monitoring: 0.00s, Memory: +0.0MB, GPU: +0.0MB
2025-07-11 16:45:35,555 - INFO - Model supports text generation
2025-07-11 16:45:36,650 - INFO - Performance test_text_generation: 1.10s, Memory: +79.2MB, GPU: +0.0MB
2025-07-11 16:45:36,651 - INFO - Performance complete_model_test: 8.01s, Memory: -260.0MB, GPU: +0.0MB
